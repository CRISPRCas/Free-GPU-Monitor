# 显卡资源监控与训练任务管理系统

这套系统包括两个脚本：`monitor_and_train.sh`和`manage_queue.sh`。这两个脚本分别用于自动监控显卡资源并根据资源情况启动训练任务，以及用于管理训练任务队列。

## monitor_and_train.sh

这个脚本会每隔30秒检查一次显卡的状态，如果存在空闲的显卡（显存占用不超过300MB），则会从队列中选择一个任务进行训练。每个任务都包括一个训练脚本和所需的显卡数量。脚本会将可用的显卡号传递给训练脚本，以启动模型训练。

如果训练脚本执行失败，那么该任务会从队列中移除，并在日志文件中进行特别标注。所有的操作日志都会记录在一个`log`文件中。

## manage_queue.sh

这个脚本提供了一个交互式的命令行界面，用于管理训练任务队列。你可以通过这个界面添加新的任务、删除已有的任务，或者修改任务的内容。每个任务都由一个训练脚本和所需的显卡数量组成。

所有的队列操作都是通过文件锁来保证线程安全的。如果在尝试修改队列时发现队列被其他进程锁定，脚本会给出提示并取消本次操作。

所有的操作日志都会记录在一个`.log`文件中，以方便跟踪和调试。

## 使用方法

1. 运行`monitor_and_train.sh`脚本以启动显卡资源监控和训练任务管理系统。你可以在后台运行这个脚本，让它在后台持续运行。

2. 运行`manage_queue.sh`脚本以打开任务管理界面。在这个界面中，你可以输入`add`、`remove`或`modify`等命令来添加、删除或修改任务。

3. 如果你想要退出任务管理界面，可以选择`quit`命令。

请注意，这两个脚本都需要在相同的目录下运行，并且需要有读写权限。队列文件和日志文件也会在这个目录下生成。